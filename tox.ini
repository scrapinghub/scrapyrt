[tox]
envlist = pre-commit,mypy,min,py39,py310,py311,py312,py313

[testenv]
deps =
    Flask
    mock
    port-for
    pytest
commands =
    pytest {posargs:-W error}

[testenv:pre-commit]
basepython = python3
deps =
    pre-commit
commands =
    pre-commit run {posargs:--all-files}

[testenv:mypy]
basepython = python3.9
deps =
    {[testenv]deps}
    mypy==1.16.1
    types-requests==2.32.4.20250611
commands =
    mypy {posargs:scrapyrt tests}

[testenv:min]
basepython = python3.9
deps =
    {[testenv]deps}
    Scrapy==2.10.0
    packaging==14.0
    # https://github.com/scrapy/scrapy/pull/6634 (addressed in Scrapy 2.13.0)
    # DeprecationWarning: twisted.web.http.HTTPClient was deprecated in
    # Twisted 24.7.0: Use twisted.web.client.Agent instead.
    Twisted<24.7.0
